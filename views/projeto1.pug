doctype html
html(lang="pt-BR")
  head
    title Monitoramento de Animais
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    link(rel="stylesheet" href="/css/design-system.css")
    link(rel="stylesheet" href="/css/projeto1.css")
    
    include ./partials/styles.pug
    script(src="/components/user-settings/settings.js")
    
  body
    // Animated background
    .glass-background
    
    // Glass navigation
    header.glass-navbar
      .container
        a.glass-logo(href="/")
          span Projetos IOT
        nav.nav-right
          if user
            button.profile-button(type="button")
              img.profile-photo(
                src=user.avatarUrl || '/img/default-avatar.png'
                alt=`${user.username}`
              )
              span.username #{user.username}

    // Main content container
    .projeto1-container
      .container
        .page-header
          h1.page-title Monitoramento de Animais
          p.page-subtitle Sistema de cadastro e monitoramento para identifica√ß√£o e controle de acesso de animais via RFID

        if error
          .glass-alert.alert-error= error
        if success
          .glass-alert.alert-success= success

        // Cards grid - layout original
        .cards-grid
          // Card de Cadastro
          .card.form-card
            .card-header
              span.card-icon üêÑ
              h3.card-title Cadastro de Animal
            
            .card-content
              form.glass-form(action="/projeto1/register" method="POST")
                .form-group
                  label.form-label(for="identifier") Identificador do animal
                  input#identifier.glass-input(type="text" name="identifier" placeholder="Ex: A123" required)
                
                .form-group
                  label.form-label(for="allowed") Permitido
                  .toggle-container
                    input#allowed.toggle-input(type="checkbox" name="allowed" value="sim")
                    label.toggle-label(for="allowed")
                      span.toggle-slider
                      span.toggle-text-off Negado
                      span.toggle-text-on Permitido
                
                .form-actions
                  button.glass-button-primary(type="submit") Cadastrar

          // Card de Monitor
          .card.records-card
            .card-header
              span.card-icon üìã
              h3.card-title Animais Registrados
            
            .card-content
              .animals-section
                .animals-list
                  if registros.length
                    each registro in registros
                      .animal-item
                        .animal-main
                          .animal-id #{registro.identifier}
                          .animal-status(class=registro.allowed === 'sim' ? 'status-allowed' : 'status-denied')
                            .status-indicator
                            span.status-text #{registro.allowed === 'sim' ? 'Permitido' : 'Negado'}
                        
                        .animal-details
                          if registro.peso
                            .detail-row
                              span.detail-label Peso:
                              span.detail-value #{registro.peso}kg
                          
                          if registro.dataPesoAtualizado
                            .detail-row
                              span.detail-label Atualizado:
                              span.detail-value #{new Date(registro.dataPesoAtualizado).toLocaleString("pt-BR")}
                          
                          if registro.registradoPor
                            .detail-row
                              span.detail-label Cadastrado por:
                              span.detail-value #{registro.registradoPor}
                          
                          if registro.data
                            .detail-row.timestamp
                              span.detail-value #{new Date(registro.data).toLocaleString("pt-BR")}
                  else
                    .empty-state
                      .empty-icon üêÑ
                      .empty-title Nenhum animal cadastrado
                      .empty-subtitle Use o formul√°rio ao lado para cadastrar o primeiro animal

        // Bot√£o de hist√≥rico
        .history-section
          button.glass-button-secondary.history-button(onclick="window.location.href='/projeto1/history'")
            span.icon üìä
            span Hist√≥rico completo dos animais

    // Incluir o card de configura√ß√µes do usu√°rio
    if user
      include ../components/user-settings/settings.pug

    script(src="/components/user-settings/settings.js")
