doctype html
html(lang="pt-BR")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title Projetos IOT
    include ./partials/styles.pug
    script(src="/components/user-settings/settings.js")
    script(src="/js/index.js")
  body
    // Barra de navega√ß√£o superior
    header.navbar
      .logo
        // Logo clic√°vel que redireciona para a p√°gina inicial
        a.logo-text(href="/") Projetos IOT
      nav.nav-right
        if user
          button.profile-button(type="button")
            img.profile-photo(
              src=user.avatarUrl || '/img/default-avatar.png'
              alt=`${user.username}`
            )
            span.username #{user.username}
        else
          // Bot√£o de login no canto superior direito
          a.login-button(href="/users") Login

  // Se√ß√£o principal (Hero)
  section.hero
    // Camada de sobreposi√ß√£o para aplicar estilo ao fundo
    .overlay 
      .hero-content
        // T√≠tulo principal do projeto
        h1.hero-title Projetos IOT
        // Descri√ß√£o do projeto
        p.hero-description Plataforma unificada para m√∫ltiplos projetos IoT, com comunica√ß√£o bidirecional via MQTT e dashboards de dados.
        if user && userProject
          // Bot√£o para acessar o projeto do usu√°rio
          a.get-started-button(href=userProject.route) Acessar #{userProject.name}
        else if user
          // Fallback se n√£o tiver projeto definido
          a.get-started-button(href="/send-files") Acessar Meus Projetos
        else
          // Bot√£o para come√ßar (leva para a p√°gina de registro)
          a.get-started-button(href="/users/register") Come√ßar
    
    // Indicador de scroll para mostrar que h√° mais conte√∫do abaixo
    if projects && projects.length > 0
      .scroll-indicator
        .scroll-text Veja os projetos dispon√≠veis
        .scroll-arrow ‚Üì

  // Se√ß√£o de Projetos Dispon√≠veis - agora fora da se√ß√£o hero
  if projects && projects.length > 0
    section.projects-section
      .container
        h2.section-title Projetos Dispon√≠veis
        .projects-grid
          each project in projects
            .project-card
              .project-header
                .project-icon
                  // √çcone do projeto (fallback se n√£o tiver)
                  if project.icon
                    img(src=project.icon alt=`√çcone ${project.name}`)
                  else
                    .default-icon üì°
                h3.project-name #{project.name}
              .project-content
                p.project-description #{project.description}
                .project-technologies
                  each tech in project.technologies
                    span.tech-tag #{tech}
                .project-features
                  each feature in project.features
                    .feature-item
                      span.feature-icon ‚úì
                      span.feature-text #{feature}
              .project-footer
                if user && user.project === project.id
                  span.current-project Projeto Atual
                else if user
                  form.switch-project-form(action="/users/settings" method="post")
                    input(type="hidden" name="project" value=project.id)
                    button.btn.btn-outline(type="submit") Trocar para este projeto
                else
                  a.btn.btn-primary(href="/users/register") Registrar-se

    // Incluir o card de configura√ß√µes do usu√°rio
    if user
      include ../components/user-settings/settings.pug
